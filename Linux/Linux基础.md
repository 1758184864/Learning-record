# 第一次课
Linux之父   Linus Torvalds   **Linux内核**
自由软件之父/GNU   Richard Stallman  **软件外壳**
GNU Not Unix
Unix：付费操作系统，源代码不开放
Linux：不一定免费，源代码开放
自由软件：不是免费软件，它可以不受限制地自由**使用、复制、研究、修改、发布**。

# 第二次课
shell
含义
1、shell命令
2、shell解释器（解释用户输入的命令，然后交给系统运行）
3、shell脚本

大多数Linux版本都是用Bash作为默认的Shell程序

命令符`[nbcc@localhost~]$`
`nbcc` 当前用户名
`localhost` 当前主机名
`~` 当前工作目录 
`$` 普通用户类型
`#` 管理员用户类型

Linux命令三类：**二进制可执行文件**、**Shell脚本文件**、**Shell内建函数**

whoami 输出当前用户用户名
```
echo 
""      输出字符串
-n ""   不换行显示
-e ""   字符串可接转义字符
```

nano 文本编辑器（ctrl+o 填入文件名 保存    ctrl+g 查看帮助文档    ctrl+x 退出）

# 第三次课
切换用户   `su 用户名`
退出用户   `exit`
清屏   `clear`
切换到当前用户主目录   `cd`
查看当前系统的Shell解释器   cat /etc/shells
帮助命令（man、help、pinfo）
创建/修改文件   vi 文件名    i进入编辑    Esc退出编辑模式  冒号进入命令模式，输入wq


**关机/重启**
命令格式：shutdown [选项...] [时间] [警告...]
```
shutdown 
-r    重启系统
-h    关闭系统
-k    仅仅发送警告，不关机或者重启
-c    取消shutdown命令
```
关机
```
shutdown 10
shutdown +10
shutdown -h 10
shutdown -h +10
shutdown -h（默认一分钟后）
```

重启
```
shutdown -r now
shutdown -r 0
shutdown -r +0
shutdown -r（默认一分钟后）
```

# 第四次课
Linux命令一般格式
命令名 [选项1] [选项2]...<参数1><参数2>...
命令名：由小写字母构成
选项：对命令的特别定义，一般以"-"开始，ls -l -a 与ls -la 相同
参数：提供命令运行的信息，或者是命令执行过程中使用的文件名
命令、选项参数之间必须有空格

在linux中，目录也是文件
目录：**创建、切换、删除、显示、查看目录**（mkdir、cd、rmdir、pwd、ls）
文件：**创建、复制、移动、删除、查看**（touch、cp、mv、rm、file、cat、head、tail、less、more）
```
mkdir 
-m 建立目录同时设置目录权限
-p  不管建立目录的上层目录是否成立，都一并创建（作用结果为，同时创建指定目录和上层目录）
```
例子：
创建一个text目录，权限444（r--r--r--）
`mkdir -m 444 text`
当前目录的test目录下创建test2，test不存在
`mkdir -p test/test2`
当前目录一次创建多个目录
`mkdir test1 test3 test 5`
`mkdir test{1,3,5}`
当前目录创建10个目录
`mkdir test{1..10}`
在/tmp目录下创建dir
`mkdir /tmp/dir`
在当前目录创建一个隐藏目录
`makdir .test`
```
drwxr-xr-x. 2 lishuang lishuang  6 2月  17 17:13 公共
```
`d`目录
`r` 4读  
`w` 2写  
`x` 1执行  
`-` 没有的权限
`rwx` 文件拥有者权限  
`r-x` 同组其他用户  
`r-x` 其他用户


```
/bin  可执行文件
/boot  系统启动所需文件
/dev  设备目录，放设备文件
/etc  配置目录，放配置文件
/home  普通用户家目录的上级目录，里面放普通用户的家目录
/lib  放库函数
/root  管理员家目录
/sbin  放管理文件，管理员才能运行
/srv  服务运行时所需信息
/tmp  临时目录，放临时文件
/opt  大型软件或者第三方软件目录
/media  可移动设备信息
```

# 第五次课
```
cd   
    默认切换到当前用户主目录
/   切换到当前用户根目录
/home/Admin/test   绝对路径写法
test    相对路径写法
```

`"~"` 当前用户主目录
`"."` 当前所在目录
`".."` 当前所在目录的上一层目录
`"-"` 退回到上一次工作目录

例子：
切换到当前目录的上上层目录
`cd ../..` 或者 `cd ../../` 

切换到当前目录下的dir目录
`cd dir`

切换到用户主目录
`cd ~用户名`

rmdir：**只能删除空目录**
语法：rmdir [选项] [目录名称]
```
rmdir/rm
    目录相对路径
    目录绝对路径
```
`rm -r 目录名 ` **空和非空都能删**

pwd：显示当前目录的绝对路径

ls：列出文件和文件属性
语法：ls [选项] [文件或目录]
```
ls
-l  列出文件属性
-a  显示所有文件和目录
-A  显示所有文件和目录，但不显示当前目录"."和上层目录".."
-i  显示文件的inode编号
文件名   查看文件存不存在
目录名   列出目录下所有文件，不包含隐藏文件
```

```
-rw-rw-r--. 1 lishuang lishuang 21 3月  11 11:19 ls
```
`-` 文件类型
`rw-rw-r--` 文件权限（拥有者、同组其他用户、其他用户）
`1` 文件硬链接数
`lishuang` 文件拥有者
`lishuang` 文件所属组
`21` 文件大小
`3月  11 11:19` 文件上次修改时间
`ls` 文件名

# 第六次课
`touch 文件的路径` 创建文件

例子：
创建一个file1文件
`touch file1`

再次创建相同名字的文件，只会更改创建时间，不会出现新文件

cp（复制文件或者目录）

语法：cp [选项] <原文件目录> <目标目录>
```
cp
-f 强行复制文件或目录，不论文件或目录是否存在
-i 覆盖前询问（使n失效）
-n 不覆盖已存在的文件（使i失效）
-u 只在源文件比目标文件新或目标文件不存在时才进行复制
-r 递归复制目录及其子目录内的所有文件
-p 复制时保留文件属性

注：f、i、n同时出现，最后一个生效
```
例子：
将file1复制到test下，重命名为file3,如果file3存在的话，则file3会被覆盖
`cp file1 test/file3`

`cat 文件名` 查看文件内容

mv(移动文件)

语法：mv [选项] <原文件目录> <目标目录>

```
-i 覆盖前询问（使n失效）
-n 不覆盖已存在的文件（使i失效）
-u 只在源文件比目标文件新或目标文件不存在时才进行复制
```

# 第七次课
文件重命名
`mv <原文件名> <现文件名>`

删除文件
```
rm
-f 不管文件存不存在，都删除
-i 询问是否删除文件
文件名  删除文件，不存在则报错
```

删除目录

```
rm
-rf 不管文件存不存在，都删除
-ri 询问是否删除目录
目录名  目录存在则删除，不存在报错
```

探测文件类型
```
file
文件名  查看文件类型
*      查看所有文件类型
```

cat(显示文本文件内容)
```
cat
-n  显示文件时对文件内容的每一行进行编号
-b  显示文件时对文件内容的每一行进行编号，不对空白行编号
-s  显示时将多行空白合一
```

head(显示文件前几行或前几个字符)
```
head
-n 行数  显示前多少行内容
-c 字符数  显示前多少个字符
-v  显示时带文件名
   显示文件全部内容
```

tail(显示文件后几行或者后几个字符)
```
tail
-n 行数  显示后多少行内容
-c 字符数  显示后多少个字符
```

按页查看文件(可前后翻页)
`less 文件名`

按页查看文件(只能向后翻)
`more 文件名`

# 第八次课

ln(创建链接文件)  默认硬链接
ln[选项] <源文件或目录> <目标文件或目录>
```
ln
    硬链接：文件别名
-s  软链接（符号链接）：文件快捷方式
-f  强制覆盖已存在文件
-i  询问是否覆盖
```

软链接：浅蓝色
断裂的软链接：背景黑，字体红


源文件和硬链接文件对应的是同一个文件，通过任意一个文件名都可以读、写、修改

如果一个文件有多个硬链接，直到最后一个硬链接被删除，它才算真正被删除

只有文本文件才可以创建硬链接

```
data 显示或设置系统时间与日期
cal 显示日历
uname 打印当前系统相关信息
clear 清除终端信息
```

# 第九次课
**vi三种模式**

1. 命令模式（一般模式）：可以移动光标，可以删除、复制、粘贴。

2. 编辑模式：i、I、O、o、a、A，文字的修改、添加

3. 命令行模式："："，将光标移动至最后一行，文本保存、查找、替换

**命令模式**
```
了解
h 左
j 下
k 上
l 右
ctrl+f 向下一页
ctrl+b 向上一页
ctrl+d 向下半页
ctrl+u 向上半页
w 光标移到所在位置后一个单词的首字母
b 光标移到所在位置前一个单词的首字母
e 光标移到所在位置后一个单词的尾字母
nx,nX nx为向后删除n个字符，nX为向前删除n个字符
x,X x为向后删除一个字符，X为向前删除一个字符
yw 复制当前光标到单词尾字符的内容到vi缓冲区
```

```
掌握
H 光标移动到当前屏幕最上方行
M 光标移动到当前屏幕中央行
L 光标移动到当前屏幕最下方行
G 光标移动到文件最后行
nG 光标移动到第n行
n<回车> 光标向下移动n行
^或0 光标移到行首
$ 光标移到行尾
n<空格> 光标向右移动n个字符
u 取消最近一次操作，可以多次取消
U 取消对当前进行的所有操作
ctrl+r 对使用u命令撤销的操作进行恢复
dd 删除光标所在的那一整行
ndd 删除光标所在行的向下n行
d1G 删除光标所在行到第一行的所有数据
dG  删除光标所在行到最后一行的所有数据
y$  复制当前光标到行尾的内容到vi缓冲区 
y^  复制当前光标到行首的内容到vi缓冲区
yy  复制光标所在行
nyy 复制光标所在行的向下n行，例如20yy，向下复制20行
y1G 复制光标所在行到第一行的所有数据
yG  复制光标所在行到最后一行的所有数据
p,P p为复制的数据粘贴在光标下一行，P为粘贴在光标的上一行
J   将光标所在行与下一行的数据结合成一行

```

# 第十次课
**编辑模式**
```
了解
r 替换光标所指的字符
R 连续替换光标所指的字符，按Esc退出
```

```
掌握
i 在光标所在处插入字符
I 在行首插入字符
a 在光标的下一个位置插入字符
A 在行末插入字符
o 在下方插入一行
O 在上方插入一行
```

**命令行模式**
```
了解
```

```
掌握
w 只对可写文件进行保存
w! 对只读文件进行保存（强制保存）
q 只有上次保存之后，文件没有被修改，才可以退出vi编辑器
q! 不对文件内容进行保存，直接退出（强制退出）
wq 保存文件并退出（针对可写文件）
wq! 强制保存并退出（针对只读文件）
w <文件名> 相当于另存为
r <文件名> 可以吧文件内容读取过来放到光标所在行前面
set nu 设置行号
set nonu 取消行号
复制移动删除
n1,n2 co n3 将n1到n2的内容复制到n3
n1,n2 m n3 将n1到n2的内容移动到n3
n1，n2 d 删除n1到n2的内容
替换
s/被替换的字符串/替换后的字符串
s/old/new 将当前行中查找到的第一个字符串"old"替换为"new"
s/old/new/g 将当前行中查找到的所有字符串"old"替换为"new"
n1,n2 s/old/new/g 将n1到n2行所有"old"字符串替换为"new"
% s/old/new/g 在整个文件范围内替换所有的字符串"old"为"new"
```

# 第十一次课
用户和用户组的管理
```
/etc/passwd 用户的基本信息
/etc/shadow 用户的密码信息
/etc/login.defs 默认配置信息
```
密码：hash密码
密码处理是单向的
原始密码-->hash密码

用户分类：
1. 管理员用户，root，ID为0，拥有所有系统权限，root用户不允许远程登录
2. 系统用户,不允许登录，是为了满足系统管理自动创建的，ID 1-999
3. 自定义用户，由管理员创建，ID 1000-60000

一个普通用户不能在其他普通用户的主目录下进行读写文件
主目录默认 /home/用户名

```
lishuang:x:1002:1002::/home/lishuang:/bin/bash
用户名：密码：UID：GID：用户描述：用户主目录：用户登录Shell
```

```
lishuang:$6$GO4YpR:18346:0:99999:7:::
用户名：密码：上次改动密码的日期（1970.1.1+18346）：密码不可以更改的天数：密码需要重置的天数：密码需要变更前警告期限：账号失效期限：账号过期的期限：保留
密码字段中，* 为禁止登录, !! 为密码未设置, ! 为用户被锁定
```

用户可以属于一个或多个组
组分为普通组合系统组
所有的组中，有一个作为用户主属组，其他的为次属组

```
/etc/group 组的基本信息
/etc/gshadow 组的密码信息
```

```
lishuang:x:1002:
组名：密码：组ID：组成员
```

```
lishuang:!::
组名：密码：管理员（默认root）：组成员
```

# 第十二次课
添加用户
```
useradd [选项] <用户名>
-u <uid> 账户的用户ID
-d <目录> 指定用户主目录
-c <备注> 加上备注文字
-g <群组> 账户的主组名称或ID
-G <群组> 账户的附加组列表
-e <有效期限> 账户的过期日期(年/月/日)
-s <shell> 登陆所使用的shell
-m/-M 创建或不创建用户主目录
-r 创建一个系统账户
```

`useradd -u 1010 -g 1030 -m /home/user2_test -s /bin/nologin -c New user`

修改用户信息
```
usermod [选项] <用户名>
-c <备注> 修改备注文字
-d <目录> 改变用户主目录，如果加上-m则会将旧主目录中的文件移动到新得目录中去（-m应加在新目录之后）
-e <有效期限> 设置账户的过期日期(年/月/日)
-g <群组> 改变账户的主属组
-G <群组> 设置账户的附属组
-l 改变用户的登录用名
-s 改变用户的默认shell
-u 改变用户UID
-L 锁住密码，使密码不可用
-U 为用户密码解锁
```

账户被锁定情况下是无法登陆的

修改或删除密码
```
passwd [选项] <用户名>
-k 保持身份验证令牌不过期
-d 删除已命名账号的密码
-l 锁定指定账户的密码
-u 解锁指定账户的密码
-e 终止指定账户的密码（不能跟时间，不能和-x/-n/-w/-i等合用
-f 强制执行操作
-x 密码需要修改的天数
-n 密码不能更改的天数
-w 在密码过期后经过多少天开始提醒用户
-i 当密码过期后经过多少天账号禁用
-S 报告已命名账号的密码状态
```

删除用户
```
userdel [选项] <用户名>
-r 删除主目录以及目录中所有文件
```

删除一个用户
- 删除/etc/passwd和/etc/shadow文件中与用户相关的记录
- 删除/etc/group和/etc/gshadow文件中与用户相关的记录
- 删除用户主目录
- 删除属于此用户的文件

# 第十三次课
添加用户组
```
groupadd [选项] <组名>
-g 组ID 用来给用户组设置ID
-p 组密码 设置组密码
```

删除用户组
```
groupdel [选项] <组名>
如果用户组是其他用户的主属组，组不能直接删除
```

修改用户组
```
-g 修改组ID
-n 修改组名
-o 允许重复GID
-p 修改密码
```

添加用户到组(次属组)
```
gpasswd
-a 向组中添加用户(只能一个一个添加)
-d 删除组用户
-r 移除组密码
-M 设置组成员列表(可以一次设置多个)
-A 设置组的管理员列表(如果将普通用户设置为管理员，权限会有所限制)
```

```
groups 用户名
显示用户所有组
```

# 第十四次课
```
newgrp 组名 把当前用户切换到指定用户组
chgrp 组名 用户名 切换用户到附属组临时有效，一旦退出，就失效
id [选项] 用户名 有用户名的情况输出指定用户信息，没有的时候输出当前用户信息
```

```
chmod [who] [+/-/=]
u 表示文件所有者
g 表示同组用户
o 表示其他用户
a 表示所有用户
```

# 第十五次课
磁盘管理
1. 添加磁盘
2. 磁盘分区
3. 磁盘、分区格式化
4. 挂载磁盘
   - 手动挂载
   - 自动挂载

硬件设备分类：
- 字符设备：必须以串行顺序依次进行访问的设备，如打印机、终端、鼠标等
- 块设备：可以用任意顺序进行访问，如硬盘、软驱、光驱等
- 网络设备：必须通过套接字来访问，要结合TCP/IP协议栈来使用

不能通过设备文件，直接访问磁盘

磁盘命名方式
hd：IDE磁盘
sd：SCSI、SATA磁盘
第三个字母表示第几块磁盘
第四个数字表示第几分区

磁盘分区
磁盘容量=主分区容量(最多4个)+扩展分区容量(最多1个)[总数不超过4个]

扩展分区的容量=所有逻辑分区的容量之和(若干个)

fdisk 分区命令
```
m:打印帮助信息
n：添加分区
d：删除分区
p：打印分区表
w：保存并退出
q：直接退出
```

查看第2块磁盘/dev/sdb的分区情况
```
fdisk -l /dev/sdb
```
查看第2块磁盘/dev/sdb的第1分区的大小
```
fdisk -s /dev/sdb1
```

# 第十六次课
磁盘使用流程
添加磁盘==>磁盘分区==>磁盘格式化==>添加挂载点==>挂载

格式化就是为每一个分区创建文件系统

格式化命令 mkfs
```
-t 文件系统类型 分区/磁盘
```
文件系统的功能：管理和存储文件

VFS(虚拟文件系统)：为文件系统和操作系统提供接口

ext：扩展文件系统
swap：交换文件系统
vFAT：是对windows、DOS操作系统下FAT(文件配置表)文件系统的统称
NFS：网络文件系统
SMB：网络文件系统
ISO9660：镜像文件系统

查看挂载情况
```
lsblk -f 
```
查看分区使用情况
```
df -k
```

linux系统没有盘符概念，任何磁盘设备的使用都需要挂载
挂载方式：手动挂载、自动挂载
挂载条件：
1. 分区已经格式化
2. 建立一个目录作为挂载点，通过此点建立操作系统和磁盘存取的接口。当磁盘挂载到目录时，对目录的操作即是对磁盘的操作
默认挂载点目录 /mnt或/media

手动挂载，系统重启后失效
```
mount 分区/磁盘 挂载点
mount /dev/sdb1 /mnt/sdb_1
```

# 第十八次课
分区的卸载
```
umount 分区设备文件名或挂载点
```

自动挂载
```
/etc/fstab
第一列  第二列  第三列   第四列   第五列   第六列
设备名  挂载点 文件系统 挂在选项 dump功能  文件系统检查次序(0不检)
```

**磁盘配额**
概念：磁盘配额就是限制某用户或者用户组对磁盘或者分区的使用量
配额类型：block限制(块限制)：使用空间大小限制
         inode限制(节点限制)：可以创建文件个数的限制

软限制：警告值，用户或者用户组使用的空间或者创建的文件大于软限制进行警告
硬限制：最大值，用户或者用户组最多可以使用多大的空间或者最多可以创建多少个文件

1. 添加挂载选项可以增加配额
```
usrquota  支持用户的配额
grpquota  支持用户组的配额
/dev/sdb1 /mnt/sdb_1          ext4    defaults,usrquota,grpquota        0 0
```
2. 重新挂载分区，默认读写
```
mount -o remount /mnt/sdb_1
```
3. 创建配额数据文件
```
quotacheck -cug 挂载点
c 创建数据文件
u 创建用户配额数据文件
g 创建用户组配额数据文件
```
4. 
- 设置用户或组的配额
```
edquota -u 用户名
edquota -g 组名
```
- 直接设置用户或组的配额
```
setquota <用户名> b(S) b(H) i(S) i(H) <挂载点>
                块的软限制、硬限制 节点的软限制、硬限制
```
- 模仿用户的配额设定
```
edquota -p <已做配额的用户> <待学习配额的用户>
```
5. 重新设置配额后要重启配额
- 启动配额
```
quotaon 挂载点
```
- 关闭配额
```
quotaoff 挂载点
```
关闭配额后，用户使用空间或者创建文件，将不受软硬限制值的要求
1. 查看配额使用情况
```
repquota -a
```

# 第二十次课
1. Linux目录结构
树形结构

重要目录
```
/dev  设备目录，放设备文件
/etc  配置目录，放配置文件
/home  普通用户家目录的上级目录，里面放普通用户的家目录
/mnt或/media 默认挂载点
```

了解
```
bin放的命令文件或执行文件
/bin 放所有用户都能运行的
/sbin 放管理员可运行的
```
```
/lost+found 放碎片文件
```

2. Linux文件命名及文件类型
文件名约束
- 不能使用特殊字符(_.+-可用)
- 区分大小写
- 最大长度256个字符

文件名扩展名：作用不明显，但创建文件最好加上，便于自己辨别

文件类型：目录文件(d)、文本文件(-)、链接文件(l)、设备文件(b块设备、c字符设备)
3. 路径
绝对路径：从根目录开始
相对路径：从当前目录开始

# 第二十一次课
修改文件权限的方法
```
chmod 权限 文件名
```
1. 通过`+``-`添加或者去掉某种权限
`chmod u+r,g+w,o+x file`
2. 通过`=`赋予某种权限
`chmod u=rwx,g=rw,o=r file`
3. 通过3位8进制分别赋予不同用户不同权限
`chmod 777 file`

修改文件拥有者
```
chown 用户名 文件名
```
1. 修改文件拥有者
`chown root file`
2. 修改文件属组
`chown :group1 file`
3. 修改文件拥有者和属组
`chown root:group1 file`

修改文件属组
`chgrp 组名 文件名` 

# 第二十二次课
文件默认权限由umask值和文件及目录的权限基数决定
文件的权限基数为666
目录的权限基数为777

默认掩码值
umask 
普通用户002
管理员022

修改掩码值 umask 掩码值

文件默认权限=文件权限基数-掩码值向下取偶的数
目录默认权限=目录权限基数-默认掩码

ext4文件系统，**强制位**和**冒险位**是特别权限，添加在执行权限(x)d的位置上，如果该位置上原已有执行权限，以小写s,t表示，否则以S,T表示

文件拥有者和属组可以设置强制位
其他用户可设置冒险位

命令文件设置强制位后，任何用户执行文件都以拥有者来执行
对一般文件设置强制位后，没有执行权限的用户也能执行文件

对目录文件的属组设置强制位后，在该目录下创建的文件及子目录会继承该目录属组

对目录设置冒险位后，此目录中，只有文件的拥有者、目录的拥有者与系统管理员才能在目录中删除此文件
